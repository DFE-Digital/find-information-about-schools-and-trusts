@page
@using DfE.FindInformationAcademiesTrusts.Extensions
@using DfE.FindInformationAcademiesTrusts.Pages.Shared
@model SingleHeadlineGradesModel

@{
    Layout = "_SchoolLayout";
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <h3 class="govuk-heading-m" data-testid="subpage-header">
            @Model.PageMetadata.SubPageName
        </h3>

        @if (Model.DateJoinedTrust is not null)
        {
            <p class="govuk-body" data-testid="academy-joined-trust-text">This academy joined the trust on
                <strong>@Model.DateJoinedTrust.ShowFullDateStringOrReplaceWithText()</strong>.
            </p>
        }

        <details class="govuk-details" data-testid="why-single-headline-not-available-details">
            <summary class="govuk-details__summary">
                <span class="govuk-details__summary-text">
                    Why a single headline grade might not be available
                </span>
            </summary>

            <div class="govuk-details__text">
                <p class="govuk-body">
                    Single headline grades stopped being awarded by Ofsted on
                    <strong>2 September 2024</strong>.
                </p>
                <p class="govuk-body">Inspections completed after this date are broken down by category.</p>
                <p class="govuk-body">You can see these on the ‘Current ratings’ and ‘Previous ratings’ pages.</p>
            </div>
        </details>

        <details class="govuk-details" data-testid="why-short-inspection-not-available-details">
            <summary class="govuk-details__summary">
                <span class="govuk-details__summary-text">
                    Why short inspection data might not be available
                </span>
            </summary>

            <div class="govuk-details__text">
                <p class="govuk-body">If a school has a short Ofsted inspection followed by a full one, data about the short inspection may not appear on this page.</p>
                <p class="govuk-body">Short inspection data for Further Education providers may not appear on this page.</p>
                <p class="govuk-body">Ofsted's inspection report will contain this data.</p>
            </div>
        </details>

        <table class="govuk-table govuk-!-margin-bottom-0 si-row-colours-table--school" data-testid="ofsted-inspection-table">
            <caption class="govuk-table__caption govuk-visually-hidden">Grades and inspection dates</caption>

            <thead class="govuk-table__head">
            <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">
                    <span class="govuk-visually-hidden">Data type</span>
                </th>
                <th scope="col" class="govuk-table__header" data-testid="date-of-inspection-header">Date of inspection</th>
                <th scope="col" class="govuk-table__header" data-testid="grade-header">Grade</th>
            </tr>
            </thead>

            <tbody class="govuk-table__body">
            @if (Model.HeadlineGrades.HasRecentShortInspection)
            {
                <tr class="govuk-table__row" data-testid="recent-short-inspection-row">
                    <th scope="row" class="govuk-table__cell">Recent short inspection</th>
                        <td class="govuk-table__cell" data-testid="recent-short-inspection-date">@Model.HeadlineGrades.ShortInspection.InspectionDate.ShowFullDateStringOrReplaceWithText("Not available")</td>
                    <td class="govuk-table__cell" data-testid="recent-short-inspection-grade">@Model.HeadlineGrades.ShortInspection.ToOutcomeDisplayString()</td>
                </tr>
            }

            <tr class="govuk-table__row" data-testid="current-full-inspection-row">
                <th scope="row" class="govuk-table__cell">Current full inspection</th>
                    <td class="govuk-table__cell" data-testid="current-full-inspection-date">@Model.HeadlineGrades.CurrentInspection.InspectionDate.ShowFullDateStringOrReplaceWithText("Not available")</td>
                <td class="govuk-table__cell" data-testid="current-full-inspection-grade">@Model.HeadlineGrades.CurrentInspection.InspectionOutcome.ToDisplayString(true)</td>
            </tr>

            <tr class="govuk-table__row" data-testid="previous-full-inspection-row">
                <th scope="row" class="govuk-table__cell">Previous full inspection</th>
                    <td class="govuk-table__cell" data-testid="previous-full-inspection-date">@Model.HeadlineGrades.PreviousInspection.InspectionDate.ShowFullDateStringOrReplaceWithText("Not available")</td>
                <td class="govuk-table__cell" data-testid="previous-full-inspection-grade">@Model.HeadlineGrades.PreviousInspection.InspectionOutcome.ToDisplayString(false)</td>
            </tr>
            </tbody>
        </table>

        <hr class="govuk-section-break govuk-section-break--m">

        <p class="govuk-body"><a class="govuk-link" href="@Model.OfstedReportUrl" rel="noreferrer noopener" target="_blank" data-testid="ofsted-inspection-reports-link">See the inspection reports at Ofsted (Opens in a new tab)</a> </p>

        <hr class="govuk-section-break govuk-section-break--m">

        
        @{
            var exportModel = new ExportButtonModel("urn", Model.Urn, "Download all Ofsted data", "download-all-ofsted-data-button");
        }
        <partial name="Shared/_ExportButton" model="exportModel"/>
    </div>
</div>
